<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Fabric Drape Area Calculator</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <div class="app-shell">
      <header class="app-header">
        <h1>Fabric Drape Area Calculator</h1>
        <p>Use a reference object (coin or rectangle) to measure drape area from a photo.</p>
      </header>

      <main class="app-main">
        <section class="panel panel-left">
          <h2>1. Load or Capture Image</h2>
          <div class="input-row">
            <label class="file-input-label">
              <span>Upload Image</span>
              <input
                type="file"
                id="uploadInput"
                accept="image/*"
              />
            </label>
          </div>
          <div class="input-row">
            <label class="file-input-label">
              <span>Capture from Camera</span>
              <input
                type="file"
                id="captureInput"
                accept="image/*"
                capture="environment"
              />
            </label>
          </div>
          <p class="hint">
            Tip: Place a coin or a rectangular card next to the fabric in the photo, lying flat.
          </p>

          <h2>2. Reference Object</h2>
          <div class="control-group">
            <div class="field">
              <label for="referenceShape">Shape</label>
              <select id="referenceShape">
                <option value="circle">Circle (coin)</option>
                <option value="rectangle">Rectangle / Square</option>
              </select>
            </div>

            <div class="field circle-only">
              <label for="refDiameter">Real diameter (cm)</label>
              <input
                type="number"
                id="refDiameter"
                min="0"
                step="0.01"
                placeholder="e.g. 2.35"
              />
            </div>

            <div class="field rect-only">
              <label for="refWidth">Real width (cm)</label>
              <input
                type="number"
                id="refWidth"
                min="0"
                step="0.01"
                placeholder="e.g. 8.5"
              />
            </div>

            <div class="field rect-only">
              <label for="refHeight">Real height (cm)</label>
              <input
                type="number"
                id="refHeight"
                min="0"
                step="0.01"
                placeholder="e.g. 5.4"
              />
            </div>

            <p class="hint">
              After image loads, choose <strong>"Mark Reference"</strong>, then drag on the image
              to outline your reference object.
            </p>

            <button id="markReferenceBtn" class="btn secondary">
              Mark Reference on Image
            </button>
          </div>

          <h2>3. Fabric Area</h2>
          <p class="hint">
            Either auto-detect from the fabric shadow, or click around the fabric edge to create a polygon, then close it to estimate the drape area.
          </p>
          <div class="control-group">
            <button id="autoFabricBtn" class="btn secondary">
              Auto Detect Fabric (Shadow)
            </button>
            <button id="startFabricBtn" class="btn secondary">
              Start Fabric Outline
            </button>
            <button id="closeFabricBtn" class="btn ghost" disabled>
              Close Fabric Outline
            </button>
            <button id="resetAllBtn" class="btn ghost">
              Reset All
            </button>
          </div>
        </section>

        <section class="panel panel-right">
          <h2>Canvas &amp; Results</h2>
          <div class="canvas-wrapper">
            <canvas id="imageCanvas"></canvas>
            <div id="canvasOverlayMessage" class="canvas-message">
              Load an image to begin.
            </div>
          </div>

          <div class="results">
            <h3>Reference</h3>
            <div class="result-row">
              <span>Reference pixel area:</span>
              <span id="refPixelArea">–</span>
            </div>
            <div class="result-row">
              <span>Reference real area (cm²):</span>
              <span id="refRealArea">–</span>
            </div>

            <h3>Fabric</h3>
            <div class="result-row">
              <span>Fabric pixel area:</span>
              <span id="fabricPixelArea">–</span>
            </div>
            <div class="result-row">
              <span>Fabric real area (cm²):</span>
              <span id="fabricRealArea">–</span>
            </div>
            <p class="hint">
              All areas are approximate. The accuracy depends on how precisely you mark the regions
              and how flat the fabric and reference lie.
            </p>
          </div>
        </section>
      </main>

      <footer class="app-footer">
        <span>Made for quick fabric drape estimation on mobile or desktop.</span>
      </footer>
    </div>

    <script src="script.js"></script>
  </body>
  </html>

